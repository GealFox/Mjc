<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <!-- Meta etiquetas SEO esenciales -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ministerio Jesucristo es el Cambio</title>
  <meta name="description" content="Ministerio Jesucristo es el Cambio: una comunidad de fe que une modernidad y espiritualidad para transformar vidas. Únete y descubre un espacio de esperanza y cambio.">
  <meta name="keywords" content="Ministerio, Jesucristo, fe, comunidad, transformación, esperanza, eventos, ayuda, donaciones">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://comunidadmjc.com.ar/">
  
  <!-- Open Graph -->
  <meta property="og:title" content="Ministerio Jesucristo es el Cambio">
  <meta property="og:description" content="Únete a una comunidad que une la fe y la modernidad para transformar vidas.">
  <meta property="og:url" content="https://comunidadmjc.com.ar/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://comunidadmjc.com.ar/imagen-og.jpg">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ministerio Jesucristo es el Cambio">
  <meta name="twitter:description" content="Únete a una comunidad que une la fe y la modernidad para transformar vidas.">
  <meta name="twitter:image" content="https://comunidadmjc.com.ar/imagen-twitter.jpg">
  
  <!-- Datos estructurados JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ReligiousOrganization",
    "name": "Ministerio Jesucristo es el Cambio",
    "url": "https://comunidadmjc.com.ar/",
    "logo": "https://comunidadmjc.com.ar/logo.png",
    "description": "Una comunidad de fe que une modernidad y espiritualidad para transformar vidas.",
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer support",
      "email": "info@comunidadmjc.com.ar"
    }
  }
  </script>
  
  <!-- Preconexión a orígenes críticos -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  
  <!-- Fuentes e íconos -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- Integración de OneSignal para notificaciones push -->
  <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  <script>
    window.OneSignalDeferred = window.OneSignalDeferred || [];
    OneSignalDeferred.push(async function(OneSignal) {
      await OneSignal.init({
        appId: "62485058-7374-4bb6-bce4-34f0b06e3925",
        safari_web_id: "web.onesignal.auto.105cd246-aae6-4c14-8684-2fd8214524d1",
        notifyButton: {
          enable: true,
        },
      });
    });
  </script>
  
  <!-- Se han removido los scripts relacionados a otras notificaciones push -->
  <style>
    /* Variables de color */
    :root {
      --primary-color: #1a1a1a;
      --accent-color: #f39c12;
      --white-bg: #ffffff;
      --grey-bg: #f7f7f7;
      --text-color: #333;
      --overlay-color: rgba(0, 0, 0, 0.6);
    }
    /* Estilos Globales */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; font-size: 62.5%; }
    body {
      font-family: 'Roboto', sans-serif;
      font-size: 1.6rem;
      background: var(--white-bg);
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
    }
    a { text-decoration: none; color: inherit; }
    img { max-width: 100%; display: block; }
    /* Fondos por sección */
    #about, #news-events, #how-to-arrive { background-color: var(--white-bg); }
    #social, #donaciones, #contact { background-color: var(--grey-bg); }
    /* Header y Navegación */
    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: var(--primary-color);
      color: #fff;
      padding: 1rem 2rem;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    header .logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.2rem;
      font-weight: 700;
    }
    nav.nav-menu ul {
      list-style: none;
      display: flex;
      gap: 2rem;
    }
    nav.nav-menu ul li a {
      font-size: 1.6rem;
      font-weight: 500;
      transition: color 0.3s ease;
    }
    nav.nav-menu ul li a:hover { color: var(--accent-color); }
    /* Menú sandwich para Mobile */
    .menu-toggle {
      display: none;
      font-size: 2.2rem;
      cursor: pointer;
    }
    /* Sección Hero */
    .hero { 
      position: relative; 
      height: 100vh; 
      width: 100%; 
      overflow: hidden; 
    }
    .video-container { 
      position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; 
    }
    .video-container video { 
      width: 100%; height: 100%; object-fit: cover; 
    }
    .hero-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(to bottom, var(--overlay-color), rgba(0,0,0,0.2));
      display: flex; justify-content: center; align-items: center;
      text-align: center; padding: 0 1rem; z-index: 2;
    }
    .hero-content h1 {
      font-family: 'Montserrat', sans-serif;
      font-size: 4rem;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.5);
      color: #fff;
    }
    .hero-content p {
      font-size: 2rem;
      margin-bottom: 2rem;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
      color: #fff;
    }
    .hero-content .btn {
      background: var(--accent-color);
      padding: 1rem 2rem;
      border: none;
      color: #fff;
      font-size: 1.8rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .hero-content .btn:hover { background: #d68910; }
    /* Secciones Generales */
    section { 
      padding: 8rem 2rem 6rem; 
      text-align: center;
      scroll-margin-top: 80px;
    }
    section h2 {
      font-family: 'Montserrat', sans-serif;
      font-size: 3rem;
      margin-bottom: 2rem;
      color: var(--primary-color);
    }
    /* Sección Sobre Nosotros */
    .about-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 3rem;
    }
    .about-content img { 
      flex: 1 1 400px; 
      border-radius: 10px; 
    }
    .about-text { 
      flex: 1 1 400px; 
      text-align: left; 
    }
    .about-text p { 
      font-size: 1.8rem; 
      line-height: 1.8; 
      margin-bottom: 1rem; 
    }
    /* Sección Redes Sociales */
    #social .gallery-container {
      margin: 0 auto;
      max-width: 1000px;
      height: 300px;
      border-radius: 15px;
      overflow: hidden;
      display: flex;
      gap: 2px;
    }
    .portada {
      flex: 1;
      background-size: cover;
      background-position: center 15%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: #fff;
      font-size: 1.5em;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .portada::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.2);
      transition: background 0.3s ease;
    }
    .portada:hover::before { background: rgba(0,0,0,0.3); }
    .portada i {
      font-size: 2.5em;
      margin-bottom: 0.3em;
      z-index: 1;
    }
    .portada span { z-index: 1; position: relative; }
    .portada1 { background-image: url('https://raw.githubusercontent.com/GealFox/Boleta/refs/heads/main/facebook.png'); }
    .portada2 { background-image: url('https://raw.githubusercontent.com/GealFox/Boleta/refs/heads/main/Instagram.jpg'); }
    .portada3 { background-image: url('https://raw.githubusercontent.com/GealFox/Boleta/refs/heads/main/Youtube.png'); }
    .portada:hover { transform: scale(1.03); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
    .portada:focus { outline: 2px solid var(--accent-color); outline-offset: 2px; }
    /* Sección Noticias y Eventos */
    #news-events { background-color: var(--white-bg); }
    #news-events .news-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto 2rem;
    }
    #news-events .news-card {
      position: relative;
      width: 100%;
      height: 350px;
      overflow: hidden;
      border-radius: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }
    #news-events .news-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    #news-events .news-card:hover img { transform: scale(1.05); }
    #news-events .card-title {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      background: rgba(0,0,0,0.70);
      color: #fff;
      font-family: 'Montserrat', sans-serif;
      font-size: 1.7rem;
      padding: 5px 10px;
      text-align: center;
      z-index: 2;
      border-bottom-left-radius: 5px;
      border-bottom-right-radius: 5px;
    }
    #news-events .overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.5s ease;
      z-index: 2;
    }
    @media (hover: hover) {
      #news-events .news-card:hover .overlay { opacity: 1; }
    }
    @media (hover: none) and (pointer: coarse) {
      #news-events .overlay { opacity: 1; }
    }
    #news-events .overlay button {
      padding: 10px 20px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 20px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #news-events .overlay button:hover { background: #d68910; }
    #news-events .card-info {
      text-align: center;
      margin-top: 5px;
    }
    #news-events .card-info p { font-size: 2.5rem; margin-top: 3px; }
    /* Modal */
    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1000;
    }
    .modal.active { opacity: 1; pointer-events: auto; }
    .modal img { max-width: 100%; max-height: 85%; border-radius: 5px; }
    .modal .info { margin-top: 15px; color: #fff; font-size: 1rem; text-align: center; }
    .modal .cal-btn {
      margin-top: 10px;
      padding: 10px 20px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .modal .cal-btn:hover { background: #d68910; }
    .modal .close {
      position: relative;
      top: 30px;
      right: -150px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      padding: 5px 9px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s ease;
    }
    .modal .close:hover { background: #d68910; }
    /* Sección Ayúdanos a Ayudar */
    #donaciones .donaciones-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 5rem;
      flex-wrap: nowrap;
      text-align: left;
    }
    .donaciones-qr {
      flex: 1 1 300px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .donaciones-qr img { max-width: 250px; border-radius: 10px; }
    .donaciones-text {
      flex: 1 1 400px;
      font-size: 1.8rem;
      line-height: 1.8;
      padding: 1rem;
    }
    /* Sección Cómo Llegar */
    #how-to-arrive .map-container {
      max-width: 1000px;
      margin: 0 auto;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    #how-to-arrive .map-container iframe {
      width: 100%;
      height: 450px;
      border: 0;
    }
    /* Sección Contacto */
    #contact form {
      background: #fff;
      max-width: 600px;
      margin: 0 auto;
      padding: 3rem;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    #contact form input,
    #contact form textarea {
      padding: 1rem;
      font-size: 1.6rem;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    #contact form button {
      background: var(--accent-color);
      color: #fff;
      padding: 1rem;
      border: none;
      font-size: 1.8rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #contact form button:hover { background: #d68910; }
    #respuesta { margin-top: 15px; font-weight: bold; }
    /* Modal de Suscripción */
    .modal-subscription {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    .modal-subscription.active {
      display: flex;
      animation: fadeIn 0.3s ease forwards;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content {
      background: var(--primary-color);
      padding: 2rem;
      border-radius: 10px;
      width: 100%;
      max-width: 500px;
      text-align: center;
      color: #fff;
      position: relative;
    }
    .modal-content .close {
      position: absolute;
      right: 1rem;
      top: 1rem;
      font-size: 2rem;
      cursor: pointer;
    }
    .modal-content form input[type="email"] {
      width: 100%;
      padding: 1rem;
      font-size: 1.6rem;
      border: none;
      border-radius: 5px;
      margin-bottom: 1.5rem;
    }
    .modal-content form button {
      background: var(--accent-color);
      border: none;
      padding: 1rem 2rem;
      font-size: 1.8rem;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .modal-content form button:hover { background: #d68910; }
    /* Pie de Página */
    footer {
      background: var(--primary-color);
      color: #fff;
      text-align: center;
      padding: 2rem;
    }
    footer p { font-size: 1.6rem; }
    footer a {
      color: var(--accent-color);
      transition: color 0.3s ease;
    }
    footer a:hover { color: #d68910; }
    /* Responsividad */
    @media (max-width: 768px) {
      nav.nav-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        background: var(--primary-color);
      }
      nav.nav-menu.active { display: block; }
      nav.nav-menu ul { flex-direction: column; padding: 1rem 0; }
      nav.nav-menu ul li { margin: 1rem 0; text-align: center; }
      .menu-toggle { display: block; }
      .about-content { flex-direction: row; text-align: center; }
      .hero-content h1 { font-size: 3.2rem; }
      .hero-content p { font-size: 1.8rem; }
      .donaciones-content { flex-direction: column; gap: 2rem; text-align: center; }
      .donaciones-qr, .donaciones-text { flex: none; width: 100%; }
      .donaciones-qr { display: flex; justify-content: center; }
    }
  </style>
</head>
<body>
  <!-- Header y Navegación -->
  <header>
    <div class="logo">MJC</div>
    <div class="menu-toggle" id="mobile-menu">
      <i class="fas fa-bars"></i>
    </div>
    <nav class="nav-menu">
      <ul>
        <li><a href="#hero">Inicio</a></li>
        <li><a href="#about">Nosotros</a></li>
        <li><a href="#social">Redes Sociales</a></li>
        <li><a href="#news-events">Noticias/Eventos</a></li>
        <li><a href="#donaciones">Ayúdanos</a></li>
        <li><a href="#how-to-arrive">Cómo Llegar</a></li>
        <li><a href="#contact">Contacto</a></li>
      </ul>
    </nav>
  </header>
  
  <!-- Sección Hero con video de fondo -->
  <section class="hero" id="hero">
    <div class="video-container">
      <video autoplay muted loop playsinline preload="auto">
        <source src="video_baja_resolucion.mp4" type="video/mp4" media="(max-width: 768px)">
        <source src="https://raw.githubusercontent.com/GealFox/Boleta/fff5ffd8c5bd8725b921a5b51fc53edb07b183e5/portada_baja.mp4" type="video/mp4">
        Tu navegador no soporta video HTML5.
      </video>
    </div>
    <div class="hero-overlay">
      <div class="hero-content">
        <h1>Bienvenidos al Ministerio</h1>
        <p>Sabemos de dónde venimos y hacia dónde vamos</p>
        <button class="btn" id="subscribeBtn">Suscríbete</button>
      </div>
    </div>
  </section>
  
  <!-- Sección Sobre Nosotros -->
  <section id="about">
    <h2>Sobre Nosotros</h2>
    <div class="about-content">
      <img src="https://raw.githubusercontent.com/GealFox/Boleta/refs/heads/main/nosotros.jpg" alt="Imagen de la iglesia">
      <div class="about-text">
        <p>En el Ministerio Jesucristo es el Cambio creemos en el poder transformador de la fe. Nuestra misión es difundir el amor de Dios y crear una comunidad unida en esperanza.</p>
        <p>Únete a nosotros y descubre un espacio donde la fe y la modernidad se fusionan para inspirar cada vida.</p>
      </div>
    </div>
  </section>
  
  <!-- Sección Redes Sociales -->
  <section id="social">
    <h2>Redes Sociales</h2>
    <div class="gallery-container">
      <div class="portada portada1" onclick="window.open('https://www.facebook.com/MJesucristoeselCambio/','_blank')" tabindex="0">
        <i class="fab fa-facebook"></i>
        <span>Facebook</span>
      </div>
      <div class="portada portada2" onclick="window.open('https://instagram.com/ministeriojesucristoeselcambio','_blank')" tabindex="0">
        <i class="fab fa-instagram"></i>
        <span>Instagram</span>
      </div>
      <div class="portada portada3" onclick="window.open('https://youtube.com/@pastorsamuelmagallanes?si=3LcIC90q2WdKiTRD','_blank')" tabindex="0">
        <i class="fab fa-youtube"></i>
        <span>YouTube</span>
      </div>
    </div>
  </section>
  
  <!-- Sección Noticias y Eventos -->
  <section id="news-events">
    <h2>Noticias y Eventos</h2>
    <div class="news-container" id="newsContainer">
      <!-- Las tarjetas se generan dinámicamente desde Google Sheets -->
    </div>
  </section>
  
  <!-- Modal para ampliar imagen y mostrar detalles -->
  <div class="modal" id="modal">
    <button class="close" id="modalClose">Cerrar</button>
    <img id="modalImage" src="" alt="Imagen ampliada">
    <div class="info" id="modalInfo"><!-- Se mostrará "Día: dd/mm/yyyy" --></div>
    <button class="cal-btn" id="calBtn">Agregar al Calendario</button>
  </div>
  
  <!-- Sección Ayúdanos a Ayudar -->
  <section id="donaciones">
    <h2>Ayúdanos a Ayudar</h2>
    <div class="donaciones-content">
      <div class="donaciones-qr">
        <img src="https://raw.githubusercontent.com/GealFox/Boleta/refs/heads/main/qr-mp.jpg" alt="QR Code para donaciones">
      </div>
      <div class="donaciones-text">
        <p>Con tu ayuda, podemos llevar asistencia a hospitales y apoyar proyectos como "Malvinas Jesús te Ama", que brinda ayuda y comida a la gente necesitada.</p>
        <p>Tus fondos se destinan a proyectos humanitarios y de asistencia social, marcando la diferencia en la vida de quienes más lo necesitan.</p>
      </div>
    </div>
  </section>
  
  <!-- Sección Cómo Llegar -->
  <section id="how-to-arrive">
    <h2>Cómo Llegar</h2>
    <div class="map-container">
      <iframe src="https://maps.google.com/maps?q=Luj%C3%A1n%204098,%20B1614BEH%20Villa%20de%20Mayo,%20Provincia%20de%20Buenos%20Aires&t=&z=15&ie=UTF8&iwloc=&output=embed" allowfullscreen loading="lazy"></iframe>
    </div>
  </section>
  
  <!-- Sección Contacto -->
  <section id="contact">
    <h2>Contáctanos</h2>
    <h3>Únete a Nuestra Familia</h3>
    <p>No importa en qué etapa de la vida te encuentres, en MJC hay un lugar especial para ti.</p><br>
    <p>¡Ven y sé parte de una comunidad que cree en el poder del cambio y en las promesas de Dios para tu vida!</p><br>
    <form id="contact-form">
      <input type="text" id="nombre" placeholder="Nombre" required>
      <input type="email" id="email" placeholder="Correo Electrónico" required>
      <textarea id="mensaje" rows="5" placeholder="Mensaje" required></textarea>
      <button type="submit">Enviar Mensaje</button>
    </form>
    <p id="respuesta"></p>
  </section>
  
  <!-- Modal de Suscripción -->
  <div class="modal-subscription" id="subscriptionModal">
    <div class="modal-content">
      <span class="close" id="modalSubClose">&times;</span>
      <h2>Suscríbete a Nuestras Noticias</h2>
      <form id="subscribeForm" action="https://docs.google.com/forms/d/e/1FAIpQLSdJaIFqkz8ZNl0cl0-zYxO6qgbhwXxCkg2Mz9WKVzDqHsc6dQ/formResponse" method="post" target="hidden_iframe">
        <input type="email" name="entry.1916208588" placeholder="Ingresa tu correo electrónico" required>
        <button type="submit">Suscribirme</button>
      </form>
      <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>
      <div id="successMessage" style="display:none; margin-top:1rem; font-size:1.6rem; color:#2ecc71;">¡Gracias por suscribirte!</div>
    </div>
  </div>
  
  <!-- Pie de Página -->
  <footer>
    <p>© 2025 Ministerio Jesucristo es el Cambio. Todos los derechos reservados.</p>
    <p>
      <a href="/privacidad">Política de Privacidad</a> | 
      <a href="/terminos">Términos de Servicio</a>
    </p>
  </footer>
  
  <script defer>
    // Menú móvil
    const mobileMenu = document.getElementById('mobile-menu');
    const navMenu = document.querySelector('nav.nav-menu');
    mobileMenu.addEventListener('click', () => {
      navMenu.classList.toggle('active');
    });
    document.querySelectorAll('nav.nav-menu ul li a').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetSection = document.getElementById(targetId);
        if (targetSection) targetSection.scrollIntoView({ behavior: 'smooth' });
        navMenu.classList.remove('active');
      });
    });
    // Modal de Suscripción
    const subscribeBtn = document.getElementById('subscribeBtn');
    const subscriptionModal = document.getElementById('subscriptionModal');
    const modalSubClose = document.getElementById('modalSubClose');
    const subscribeForm = document.getElementById('subscribeForm');
    const successMessage = document.getElementById('successMessage');
    subscribeBtn.addEventListener('click', () => { subscriptionModal.classList.add('active'); });
    modalSubClose.addEventListener('click', () => { subscriptionModal.classList.remove('active'); });
    window.addEventListener('click', (e) => { if (e.target === subscriptionModal) subscriptionModal.classList.remove('active'); });
    subscribeForm.addEventListener('submit', function(e) {
      const email = this.querySelector('input[type="email"]').value;
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        e.preventDefault();
        alert('Por favor, ingresa un email válido.');
      } else {
        setTimeout(() => { successMessage.style.display = 'block'; this.reset(); }, 1000);
      }
    });
    // Reiniciar video
    const video = document.querySelector('.video-container video');
    video.addEventListener('ended', () => { video.play(); });
    // Noticias y Eventos
    let modalEventTitle = "", modalEventDate = "";
    async function loadNews() {
      const sheetId = "1YnA2B_6bGT7cVVEm_j0FhFl1MtW_3GsTZo6cXmpc6-s";
      const sheetName = "Noticias";
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&sheet=${sheetName}`;
      try {
        const response = await fetch(url);
        const text = await response.text();
        const jsonText = text.match(/{.*}/)[0];
        const json = JSON.parse(jsonText);
        const rows = json.table.rows;
        const container = document.getElementById("newsContainer");
        container.innerHTML = "";
        const hoy = new Date(); hoy.setHours(0,0,0,0); 
        let count = 0;
        rows.forEach(row => {
          const titulo = row.c[1] ? row.c[1].v : "Sin Título";
          const fechaStr = row.c[2] ? row.c[2].f : "";
          const urlDrive = row.c[3] ? row.c[3].v : "";
          if (fechaStr) {
            const partes = fechaStr.split("-");
            if (partes.length === 3) {
              const eventDate = new Date(parseInt(partes[0]), parseInt(partes[1]) - 1, parseInt(partes[2]));
              eventDate.setHours(0,0,0,0);
              if (eventDate >= hoy) {
                let urlImagen = "https://via.placeholder.com/300";
                const match = urlDrive.match(/[-\w]{25,}/);
                if (match) { urlImagen = `https://lh3.googleusercontent.com/d/${match[0]}=s1600`; }
                const dia = ("0" + eventDate.getDate()).slice(-2);
                const mes = ("0" + (eventDate.getMonth()+1)).slice(-2);
                const anio = eventDate.getFullYear();
                const fechaDisplay = `${dia}/${mes}/${anio}`;
                const card = document.createElement("div");
                card.classList.add("news-card");
                card.innerHTML = `
                  <div class="card-title">${titulo}</div>
                  <img src="${urlImagen}" alt="${titulo}">
                  <div class="overlay">
                    <button class="ampliarBtn">Ampliar</button>
                  </div>
                  <div class="card-info">
                    <p>Día: ${fechaDisplay}</p>
                  </div>
                `;
                container.appendChild(card);
                count++;
                card.querySelector(".ampliarBtn").addEventListener("click", () => abrirModal(urlImagen, titulo, fechaDisplay));
                card.querySelector("img").addEventListener("click", () => abrirModal(urlImagen, titulo, fechaDisplay));
              }
            }
          }
        });
        if (count === 0) { 
          container.innerHTML = "<p>No hay eventos vigentes.</p>"; 
        } else {
          // Si hay nuevas noticias/eventos, se envía una notificación push única por día.
          let lastNewsNotificationDate = localStorage.getItem("lastNewsNotificationDate");
          let todayStr = new Date().toISOString().slice(0,10);
          if (lastNewsNotificationDate !== todayStr && window.OneSignal && window.OneSignal.sendSelfNotification) {
            window.OneSignal.sendSelfNotification({
              title: "Nuevas Noticias y Eventos",
              message: "¡Revisa las últimas noticias y eventos!",
              url: window.location.href,
              icon: "https://comunidadmjc.com.ar/logo.png"
            });
            localStorage.setItem("lastNewsNotificationDate", todayStr);
          }
        }
      } catch (error) { 
        console.error("Error al cargar las noticias:", error); 
      }
    }
    function abrirModal(urlImagen, titulo, fechaDisplay) {
      modalEventTitle = titulo;
      modalEventDate = fechaDisplay;
      const modal = document.getElementById("modal");
      const modalImage = document.getElementById("modalImage");
      const modalInfo = document.getElementById("modalInfo");
      modalImage.src = urlImagen;
      modalInfo.textContent = `Día: ${fechaDisplay}`;
      modal.classList.add("active");
    }
    document.getElementById("modalClose").addEventListener("click", () => { document.getElementById("modal").classList.remove("active"); });
    document.getElementById("modal").addEventListener("click", (e) => { if (e.target.id === "modal") document.getElementById("modal").classList.remove("active"); });
    function agregarAlCalendario(titulo, fechaDisplay) {
      const partes = fechaDisplay.split("/");
      if (partes.length !== 3) return;
      const [dia, mes, anio] = partes;
      const dtstart = `${anio}${mes}${dia}`;
      const dateObj = new Date(parseInt(anio), parseInt(mes) - 1, parseInt(dia));
      dateObj.setDate(dateObj.getDate() + 1);
      const dtend = `${dateObj.getFullYear()}${("0"+(dateObj.getMonth()+1)).slice(-2)}${("0"+dateObj.getDate()).slice(-2)}`;
      const calUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(titulo)}&dates=${dtstart}/${dtend}&ctz=America/Argentina/Buenos_Aires`;
      window.open(calUrl, "_blank");
    }
    document.getElementById("calBtn").addEventListener("click", () => { agregarAlCalendario(modalEventTitle, modalEventDate); });
    loadNews();
    // Formulario de Contacto
    document.getElementById("contact-form").addEventListener("submit", async function (e) {
      e.preventDefault();
      const respuestaElemento = document.getElementById("respuesta");
      respuestaElemento.textContent = "Enviando...";
      const nombre = document.getElementById("nombre").value.trim();
      const email = document.getElementById("email").value.trim();
      const mensaje = document.getElementById("mensaje").value.trim();
      if (!nombre || !email || !mensaje) {
        respuestaElemento.textContent = "Por favor, completa todos los campos.";
        return;
      }
      const url = "https://script.google.com/macros/s/AKfycbzDDpyOWSS5s-nNFbvwIaPIJHiMOBLd_HUlt_kcdh7Wts1r6KjTXZoyYDJb3usJFqzK/exec";
      const params = new URLSearchParams();
      params.append("nombre", nombre);
      params.append("email", email);
      params.append("mensaje", mensaje);
      try {
        const response = await fetch(url, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: params
        });
        const text = await response.text();
        if (text.trim() === "OK") {
          respuestaElemento.textContent = "¡Mensaje enviado con éxito!";
          document.getElementById("contact-form").reset();
        } else {
          respuestaElemento.textContent = "Error al enviar el mensaje.";
          console.error("Respuesta del servidor:", text);
        }
      } catch (error) {
        console.error("Error de conexión:", error);
        respuestaElemento.textContent = "Error de conexión.";
      }
    });
  </script>
</body>
</html>
